<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>Examples</title>
<meta name="description" content="">
<meta name="keywords" content="">
<link href="" rel="stylesheet">
<script type="text/javascript" src="http://apps.bdimg.com/libs/jquery/1.9.1/jquery.min.js"></script>
<style>
	html,body,div,ul,li,p{
		margin:0;
		padding:0;
	}
	ul,li{
		list-style: none;
	}
	.clearfix:after{
		content: '';
		display: block;
		clear: both;
	}

	.container{
		/*border:1px solid red;*/
		width: 745px;
		margin:0 auto;
	}
	.container li{
		float: left;
		margin:10px 10px;
	}
	.container li img{
		/*border: 1px solid;*/
		width: 350px;
		height: 350px;
	}
	p{
		float: left;
	}
</style>
</head>
<body>
   <ul class="container clearfix">
   		<li><a href="#"><img src="http://kejian.jirengu.com/data/fe/%E8%AF%BE%E4%BB%B6/32-%E6%87%92%E5%8A%A0%E8%BD%BD/code/blank.jpg" data-src="http://cdn.jirengu.com/book.jirengu.com/img/1.jpg" /></a></li>
	  	<li><a href="#"><img src="http://kejian.jirengu.com/data/fe/%E8%AF%BE%E4%BB%B6/32-%E6%87%92%E5%8A%A0%E8%BD%BD/code/blank.jpg" data-src="http://cdn.jirengu.com/book.jirengu.com/img/1.jpg" /></a></li>
	  	<li><a href="#"><img src="http://kejian.jirengu.com/data/fe/%E8%AF%BE%E4%BB%B6/32-%E6%87%92%E5%8A%A0%E8%BD%BD/code/blank.jpg" data-src="http://cdn.jirengu.com/book.jirengu.com/img/2.jpg" /></a></li>
  		<li><a href="#"><img src="http://kejian.jirengu.com/data/fe/%E8%AF%BE%E4%BB%B6/32-%E6%87%92%E5%8A%A0%E8%BD%BD/code/blank.jpg" data-src="http://cdn.jirengu.com/book.jirengu.com/img/3.jpg" /></a></li>
  		<li><a href="#"><img src="http://kejian.jirengu.com/data/fe/%E8%AF%BE%E4%BB%B6/32-%E6%87%92%E5%8A%A0%E8%BD%BD/code/blank.jpg" data-src="http://cdn.jirengu.com/book.jirengu.com/img/4.jpg" /></a></li>
  		<li><a href="#"><img src="http://kejian.jirengu.com/data/fe/%E8%AF%BE%E4%BB%B6/32-%E6%87%92%E5%8A%A0%E8%BD%BD/code/blank.jpg" data-src="http://cdn.jirengu.com/book.jirengu.com/img/5.jpg" /></a></li>
  		<li><a href="#"><img src="http://kejian.jirengu.com/data/fe/%E8%AF%BE%E4%BB%B6/32-%E6%87%92%E5%8A%A0%E8%BD%BD/code/blank.jpg" data-src="http://cdn.jirengu.com/book.jirengu.com/img/6.jpg" /></a></li>
  		<li><a href="#"><img src="http://kejian.jirengu.com/data/fe/%E8%AF%BE%E4%BB%B6/32-%E6%87%92%E5%8A%A0%E8%BD%BD/code/blank.jpg" data-src="http://cdn.jirengu.com/book.jirengu.com/img/7.jpg" /></a></li>
  		<li><a href="#"><img src="http://kejian.jirengu.com/data/fe/%E8%AF%BE%E4%BB%B6/32-%E6%87%92%E5%8A%A0%E8%BD%BD/code/blank.jpg" data-src="http://cdn.jirengu.com/book.jirengu.com/img/8.jpg" /></a></li>
  		<li><a href="#"><img src="http://kejian.jirengu.com/data/fe/%E8%AF%BE%E4%BB%B6/32-%E6%87%92%E5%8A%A0%E8%BD%BD/code/blank.jpg" data-src="http://cdn.jirengu.com/book.jirengu.com/img/9.jpg" /></a></li>
  		<li><a href="#"><img src="http://kejian.jirengu.com/data/fe/%E8%AF%BE%E4%BB%B6/32-%E6%87%92%E5%8A%A0%E8%BD%BD/code/blank.jpg" data-src="http://cdn.jirengu.com/book.jirengu.com/img/10.jpg" /></a></li>
  		<li><a href="#"><img src="http://kejian.jirengu.com/data/fe/%E8%AF%BE%E4%BB%B6/32-%E6%87%92%E5%8A%A0%E8%BD%BD/code/blank.jpg" data-src="http://cdn.jirengu.com/book.jirengu.com/img/11.jpg" /></a></li>
  		<li><a href="#"><img src="http://kejian.jirengu.com/data/fe/%E8%AF%BE%E4%BB%B6/32-%E6%87%92%E5%8A%A0%E8%BD%BD/code/blank.jpg" data-src="http://cdn.jirengu.com/book.jirengu.com/img/12.jpg" /></a></li>
  		<li><a href="#"><img src="http://kejian.jirengu.com/data/fe/%E8%AF%BE%E4%BB%B6/32-%E6%87%92%E5%8A%A0%E8%BD%BD/code/blank.jpg" data-src="http://cdn.jirengu.com/book.jirengu.com/img/13.jpg" /></a></li>
  		<li><a href="#"><img src="http://kejian.jirengu.com/data/fe/%E8%AF%BE%E4%BB%B6/32-%E6%87%92%E5%8A%A0%E8%BD%BD/code/blank.jpg" data-src="http://cdn.jirengu.com/book.jirengu.com/img/14.jpg" /></a></li>
  		<li><a href="#"><img src="http://kejian.jirengu.com/data/fe/%E8%AF%BE%E4%BB%B6/32-%E6%87%92%E5%8A%A0%E8%BD%BD/code/blank.jpg" data-src="http://cdn.jirengu.com/book.jirengu.com/img/15.jpg" /></a></li>
  		<li><a href="#"><img src="http://kejian.jirengu.com/data/fe/%E8%AF%BE%E4%BB%B6/32-%E6%87%92%E5%8A%A0%E8%BD%BD/code/blank.jpg" data-src="http://cdn.jirengu.com/book.jirengu.com/img/16.jpg" /></a></li><li><a href="#"><img src="http://kejian.jirengu.com/data/fe/%E8%AF%BE%E4%BB%B6/32-%E6%87%92%E5%8A%A0%E8%BD%BD/code/blank.jpg" data-src="http://cdn.jirengu.com/book.jirengu.com/img/17.jpg" /></a></li>

  		<p class="hello">hello</p>
  		<p class="world">world</p>
   </ul> 

	<script>
   		
   		function Exposure($target,callback){
   			this.$target=$target;
   			this.callback=callback; //callback函数名
   			this.bind();
   			this.check();		
   		}

   		Exposure.prototype.bind = function(){
   			var _this = this;
			$(window).on('scroll',function(){
				if( !_this.$target.data('isLoaded') ){ //设置data为了防止重复加载图片
					_this.check();
				}
			});	
   		}

   		Exposure.prototype.check = function(){
   			var _this = this;
   			if( this.isShow(this.$target) ){
   				setTimeout(function(){
   					_this.callback(_this.$target);
   				},1000);
   				this.$target.data('isLoaded',true);
   			}
   		}

   		Exposure.prototype.isShow = function(){
   			var windowHeight = $(window).height(),
   				scrollTop = $(window).scrollTop(),
   				offsetTop = this.$target.offset().top,
   				nodeHeight = this.$target.height()
   			if( offsetTop < windowHeight+scrollTop && scrollTop < offsetTop+nodeHeight ){
   				return true;
   			}else{
   				return false;
   			}
   			//console.log(1);
   		}

   		var Lazy = (function(){

   			return {
   				init:function($target,callback){
   					$target.each(function(idx,target){
   						new Exposure($(target),callback);
   					});
   				}
   			}

   		})()


   		// new Exposure( $('.hello'),function($node){
   		// 	$('.hello').text( $('.hello').text() +　'123' );
   		// });
   		// new Exposure( $('.world'),function($node){
   		// 	$('.world').text( $('.world').text() +　'456' );
   		// });
   		// $('.container img').each(function(idx,img){
   		// 	new Exposure( $(img),function($node){
   		// 		showImg($node);
   		// 	})
   		// })
		
		Lazy.init( $('.hello'),function($node){
			$node.text( $node.text() + '123'); //虽然防止了图片重复加载，但是这里也防止了重复加载了，不知道怎么办？
		} );
		Lazy.init( $('.world'),function($node){
			$node.text( $node.text() + '456');
		} );
		Lazy.init( $('.container img'),function($node){
			showImg($node);
		} );

   		function showImg($img){
   			imgUrl = $img.attr('data-src');
   			$img.attr('src',imgUrl); 
   		}
	</script>
   	

</body>
</html>